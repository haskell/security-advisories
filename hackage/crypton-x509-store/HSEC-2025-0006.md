``` toml
[advisory]
cwe = [403]
date = 2025-11-17T02:22:38Z
id = "HSEC-2025-0006"
keywords = ["crypto"]
modified = 2025-11-17T02:22:38Z

[[affected]]
cvss = "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N"
package = "x509-store"

[[affected.versions]]
introduced = "0.1"

[[affected]]
cvss = "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N"
package = "crypton-x509-store"

[[affected.versions]]
fixed = "1.6.12"
introduced = "1.6.9"

[[references]]
type = "FIX"
url = "https://github.com/kazu-yamamoto/crypton-certificate/commit/e353d450c381c9d6b903c4257927e0c89c97acb1"
```

# Private key leak via inherited file descriptor

The X.509 key reading function `readKeyFile` opened a file descriptor to
the private key without setting the *close-on-exec* flag. If a child
process is `exec`ed at the same time, it would inherit that file
descriptor and could read the private key material.

Impact is limited to child processes that run untrusted code, but that
do not close inherited file descriptors. (For example, the `su(1)`
command.)

This leak was fixed by setting the *close-on-exec* flag on unix-based
systems.
