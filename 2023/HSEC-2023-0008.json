{"affected":[{"package":{"ecosystem":"Hackage","name":"hledger-web"},"ranges":[{"events":[{"introduced":"0.24"},{"fixed":"1.23"}],"type":"ECOSYSTEM"}],"severity":[{"score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N","type":"CVSS_V3"}]}],"aliases":["CVE-2021-46888"],"details":"# Stored XSS in *hledger-web*\n\nAn issue was discovered in *hledger-web* < 1.23. A Stored Cross-Site\nScripting (XSS) vulnerability exists in `toBloodhoundJson` that\nallows an attacker to execute JavaScript by encoding user-controlled\nvalues in a payload with base64 and parsing them with the `atob`\nfunction.\n\n*hledger-web* forms sanitise obvious JavaScript, but not obfuscated\nJavaScript (see [OWASP Filter Evasion Cheat Sheet][cheatsheet]).\nThis means *hledger-web* instances, especially anonymously-writable\nones like `demo.hledger.org`, could be loaded with malicious\nJavaScript to be executed by subsequent visitors.\n\n[cheatsheet]: https://owasp.org/www-community/xss-filter-evasion-cheatsheet\n\nReported by Gaspard Baye and Hamidullah Muslih.  Fix by Arsen\nArsenoviÄ‡.\n","id":"HSEC-2023-0008","modified":"2023-07-26T10:34:39Z","published":"2023-07-22T12:23:10Z","references":[{"type":"REPORT","url":"https://github.com/simonmichael/hledger/issues/1525"},{"type":"INTRODUCED","url":"https://github.com/simonmichael/hledger/commit/ec51d28839b2910eea360b1b8c72904b51cf7821"},{"type":"EVIDENCE","url":"https://www.youtube.com/watch?v=QnRO-VkfIic"},{"type":"FIX","url":"https://github.com/simonmichael/hledger/pull/1663"}],"schema_version":"1.5.0","summary":"Stored XSS in hledger-web"}
