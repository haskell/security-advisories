<!DOCTYPE HTML><html><html lang="en"><head><meta charset="UTF-8"><base href=".."><link rel="alternate" type="application/atom+xml" href="https://haskell.github.io/security-advisories/atom.xml"><link rel="stylesheet" href="assets/css/default.css"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Haskell Security advisories"><title>Haskell Security advisories</title></head><body><div class="nav-bar"><ul class="items"><li class><a href="by-dates.html">by date</a></li><li class><a href="by-packages.html">by package</a></li></ul></div><h1>HSEC-2025-0002</h1><div class="content"><div id="advisory"><h1>Double Public Key Signing Function Oracle Attack on Ed25519</h1>
<p>The standard specification of Ed25519 message signing involves
providing the algorithm with a message and private key.</p>
<p>The function will use the private key to compute the public key and
sign the message. Some libraries provide a variant of the message
signing function that also takes the pre-computed public key as an input
parameter.</p>
<p>Libraries that allow arbitrary public keys as inputs without checking
if the input public key corresponds to the input private key are
vulnerable to the following attack.</p>
<p>By using several public keys and messages, a malicious user with
access to the signing mechanism may build up insights into the private
key parameters resulting in access to the private key.</p>
<p>This shortcoming means that an attacker could use the signing
function as an Oracle, perform crypto-analysis and ultimately get at
secrets. For example, an attacker who canâ€™t access the private key but
can access the signing mechanism through an API call could use several
public keys and messages to gradually build up insights into private key
parameters.</p><h3>Info</h3><dl><dt>Published</dt><dd>April 03, 2025</dd><dt>Modified</dt><dd>April 03, 2025</dd><dt>CAPECs</dt><dd><i>&lt; none &gt;</i></dd><dt>CWEs</dt><dd><i>&lt; none &gt;</i></dd><dt>Keywords</dt><dd>crypto</dd><dt>Aliases</dt><dd><i>&lt; none &gt;</i></dd><dt>Related</dt><dd>GHSA-w5vr-6qhr-36cc</dd><dt>References</dt><dd><a href="https://portswigger.net/daily-swig/dozens-of-cryptography-libraries-vulnerable-to-private-key-theft">[ARTICLE] https://portswigger.net/daily-swig/dozens-of-cryptography-libraries-vulnerable-to-private-key-theft</a></dd><dd><a href="https://github.com/MystenLabs/ed25519-unsafe-libs">[ARTICLE] https://github.com/MystenLabs/ed25519-unsafe-libs</a></dd><dd><a href="https://github.com/advisories/GHSA-w5vr-6qhr-36cc">[ADVISORY] https://github.com/advisories/GHSA-w5vr-6qhr-36cc</a></dd><dd><a href="https://hackage.haskell.org/package/cryptonite-0.30/docs/src/Crypto.PubKey.Ed25519.html#sign">[EVIDENCE] https://hackage.haskell.org/package/cryptonite-0.30/docs/src/Crypto.PubKey.Ed25519.html#sign</a></dd><dd><a href="https://github.com/haskell-crypto/cryptonite/blob/cryptonite-v0.30/cbits/ed25519/ed25519.c#53">[EVIDENCE] https://github.com/haskell-crypto/cryptonite/blob/cryptonite-v0.30/cbits/ed25519/ed25519.c#53</a></dd><dd><a href="https://github.com/kazu-yamamoto/crypton/blob/48fb9df2de5ee752196724b081f4d3cdb57576ed/cbits/ed25519/ed25519.c#L53">[EVIDENCE] https://github.com/kazu-yamamoto/crypton/blob/48fb9df2de5ee752196724b081f4d3cdb57576ed/cbits/ed25519/ed25519.c#L53</a></dd><dd><a href="https://github.com/kazu-yamamoto/crypton/pull/47">[FIX] https://github.com/kazu-yamamoto/crypton/pull/47</a></dd></dl><h4>Affected</h4><h5><a href="https://hackage.haskell.org/package/cryptonite"><code>cryptonite</code></a></h5><dl><dt>CVSS</dt><dd>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N</dd><dt>Versions</dt><dd><code>&gt;=0.1</code></dd><dt>Declarations</dt><dd><i>&lt; none &gt;</i></dd></dl><h5><a href="https://hackage.haskell.org/package/crypton"><code>crypton</code></a></h5><dl><dt>CVSS</dt><dd>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N</dd><dt>Versions</dt><dd><code>&gt;=0.31 &amp;&amp; &lt;1.0.3</code></dd><dt>Declarations</dt><dd><i>&lt; none &gt;</i></dd></dl></div></div><footer><div class="HF">This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The Haskell Foundation</a>.</div></footer></body></html></html>