<!DOCTYPE HTML><html><html lang="en"><head><meta charset="UTF-8"><base href=".."><link rel="alternate" type="application/atom+xml" href="https://haskell.github.io/security-advisories/atom.xml"><link rel="stylesheet" href="assets/css/default.css"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Haskell Security advisories"><title>Haskell Security advisories</title></head><body><div class="nav-bar"><ul class="items"><li class><a href="by-dates.html">by date</a></li><li class><a href="by-packages.html">by package</a></li></ul></div><h1>HSEC-2023-0009</h1><div class="content"><div id="advisory"><h1><em>git-annex</em> command injection via malicious SSH hostname</h1>
<p><em>git-annex</em> was vulnerable to the same class of security hole
as git's <strong>CVE-2017-1000117</strong>. In several cases,
<code>git-annex</code> parses a repository URL, and uses it to generate
a <code>ssh</code> command, with the hostname to ssh to coming from the
URL. If the hostname it parses is something like
<code>-eProxyCommand=evil</code>, this could result in arbitrary local
code execution.</p>
<p>Some details of URL parsing may prevent the exploit working in some
cases.</p>
<p>Exploiting this would involve the attacker tricking the victim into
adding a remote something like
<code>ssh://-eProxyCommand=evil/blah</code>.</p>
<p>One possible avenue for an attacker that avoids exposing the URL to
the user is to use <code>initremote</code> with an SSH remote, so
embedding the URL in the <em>git-annex</em> branch. Then the victim
would enable it with <code>enableremote</code>.</p>
<p>This was fixed in version <strong>6.20170818</strong>. Now there's a
<code>SshHost</code> type that is not allowed to start with a dash, and
every invocation of <code>git-annex</code> uses a function that takes a
<code>SshHost</code>.</p><h3>Info</h3><dl><dt>Published</dt><dd>July 25, 2023</dd><dt>Modified</dt><dd>July 25, 2023</dd><dt>CAPECs</dt><dd><i>&lt; none &gt;</i></dd><dt>CWEs</dt><dd><a href="https://cwe.mitre.org/data/definitions/20.html">20</a></dd><dd><a href="https://cwe.mitre.org/data/definitions/78.html">78</a></dd><dt>Keywords</dt><dd>ssh, command-injection, historical</dd><dt>Aliases</dt><dd>CVE-2017-12976</dd><dt>Related</dt><dd>CVE-2017-9800, CVE-2017-12836, CVE-2017-1000116, CVE-2017-1000117</dd><dt>References</dt><dd><a href="https://git-annex.branchable.com/security/CVE-2017-12976/">[ADVISORY] https://git-annex.branchable.com/security/CVE-2017-12976/</a></dd><dd><a href="http://source.git-annex.branchable.com/?p=source.git;a=commitdiff;h=df11e54788b254efebb4898b474de11ae8d3b471">[FIX] http://source.git-annex.branchable.com/?p=source.git;a=commitdiff;h=df11e54788b254efebb4898b474de11ae8d3b471</a></dd></dl><h4>Affected</h4><h5><a href="https://hackage.haskell.org/package/git-annex"><code>git-annex</code></a></h5><dl><dt>CVSS</dt><dd>CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H</dd><dt>Versions</dt><dd><code>&gt;=0 &amp;&amp; &lt;6.20170818</code></dd><dt>Declarations</dt><dd><i>&lt; none &gt;</i></dd></dl></div></div><footer><div class="HF">This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The Haskell Foundation</a>.</div></footer></body></html></html>