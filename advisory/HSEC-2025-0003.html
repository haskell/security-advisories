<!DOCTYPE HTML><html><html lang="en"><head><meta charset="UTF-8"><base href=".."><link rel="alternate" type="application/atom+xml" href="https://haskell.github.io/security-advisories/atom.xml"><link rel="stylesheet" href="assets/css/default.css"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Haskell Security advisories"><title>Haskell Security advisories</title></head><body><div class="nav-bar"><ul class="items"><li class><a href="by-dates.html">by date</a></li><li class><a href="by-packages.html">by package</a></li></ul></div><h1>HSEC-2025-0003</h1><div class="content"><div id="advisory"><h1>Use after free in multithreaded lzma (.xz) decoder</h1>
<p>In XZ Utils 5.3.3alpha to 5.8.0, the multithreaded .xz decoder in
liblzma has a bug where invalid input can at least result in a crash
(CVE-2025-31115). The effects include heap use after free and writing to
an address based on the null pointer plus an offset. Applications and
libraries that use the <code>lzma_stream_decoder_mt</code> function are
affected.</p>
<p>The Haskell <em>xz-clib</em> library vendors and builds the C
implementation. The <em>xz</em> package does not use the multithreaded
decoder and is therefore unaffected.</p><h3>Info</h3><dl><dt>Published</dt><dd>November 14, 2025</dd><dt>Modified</dt><dd>November 14, 2025</dd><dt>CAPECs</dt><dd><i>&lt; none &gt;</i></dd><dt>CWEs</dt><dd><a href="https://cwe.mitre.org/data/definitions/416.html">416</a></dd><dt>Keywords</dt><dd>corruption, vendored-code, language-c</dd><dt>Aliases</dt><dd>CVE-2025-31115</dd><dt>Related</dt><dd><i>&lt; none &gt;</i></dd><dt>References</dt><dd><a href="https://tukaani.org/xz/threaded-decoder-early-free.html">[ARTICLE] https://tukaani.org/xz/threaded-decoder-early-free.html</a></dd><dd><a href="https://github.com/tukaani-project/xz/commit/d5a2ffe41bb77b918a8c96084885d4dbe4bf6480">[FIX] https://github.com/tukaani-project/xz/commit/d5a2ffe41bb77b918a8c96084885d4dbe4bf6480</a></dd><dd><a href="https://github.com/hasufell/lzma-static/commit/e95fe96530568addfc83b771900025053e2c6951">[FIX] https://github.com/hasufell/lzma-static/commit/e95fe96530568addfc83b771900025053e2c6951</a></dd></dl><h4>Affected</h4><h5><a href="https://hackage.haskell.org/package/xz-clib"><code>@hackage/xz-clib</code></a></h5><dl><dt>CVSS</dt><dd>CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L</dd><dt>Versions</dt><dd><code>&gt;=5.6.3 &amp;&amp; &lt;5.8.1</code></dd><dt>Declarations</dt><dd><i>&lt; none &gt;</i></dd></dl></div></div><footer><div class="HF">This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The Haskell Foundation</a>.</div></footer></body></html></html>