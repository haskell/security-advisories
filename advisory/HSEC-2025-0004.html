<!DOCTYPE HTML><html><html lang="en"><head><meta charset="UTF-8"><base href=".."><link rel="alternate" type="application/atom+xml" href="https://haskell.github.io/security-advisories/atom.xml"><link rel="stylesheet" href="assets/css/default.css"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Haskell Security advisories"><title>Haskell Security advisories</title></head><body><div class="nav-bar"><ul class="items"><li class><a href="by-dates.html">by date</a></li><li class><a href="by-packages.html">by package</a></li></ul></div><h1>HSEC-2025-0004</h1><div class="content"><div id="advisory"><h1>Broken Path Sanitization in spacecookie Library</h1>
<p>The spacecookie library exposes the functions
<code>sanitizePath</code> and <code>sanitizeIfNotUrl</code> intended to
remove <code>..</code> components from paths which can be used to
prevent path traversal attacks. Due to erroneous comparison code, this
elimination is not actually performed which has been remedied in version
1.0.0.3 by properly comparing using <code>equalFilePath</code>.</p>
<p>Any user of those respective functions of any version of spacecookie
should upgrade to 1.0.0.3 or later. Note that the spacecookie server
executable included in the same package is not affected by the problem
since a separate check would reject any malicious path that gets by
<code>sanitizePath</code>.</p><h3>Info</h3><dl><dt>Published</dt><dd>May 06, 2025</dd><dt>Modified</dt><dd>May 06, 2025</dd><dt>CAPECs</dt><dd><a href="https://capec.mitre.org/data/definitions/126.html">126</a></dd><dt>CWEs</dt><dd><a href="https://cwe.mitre.org/data/definitions/23.html">23</a></dd><dt>Keywords</dt><dd>gopher, path-traversal</dd><dt>Aliases</dt><dd><i>&lt; none &gt;</i></dd><dt>Related</dt><dd><i>&lt; none &gt;</i></dd><dt>References</dt><dd><a href="https://github.com/sternenseemann/spacecookie/commit/2854a8a70833e7abdeeff3c02596a6f2a2f35c61">[FIX] https://github.com/sternenseemann/spacecookie/commit/2854a8a70833e7abdeeff3c02596a6f2a2f35c61</a></dd></dl><h4>Affected</h4><h5><a href="https://hackage.haskell.org/package/spacecookie"><code>spacecookie</code></a></h5><dl><dt>CVSS</dt><dd>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N</dd><dt>Versions</dt><dd><code>&gt;=0.2.0.0 &amp;&amp; &lt;1.0.0.3</code></dd><dt>Declarations</dt><dd><code>Network.Gopher.Util.sanitizeIfNotUrl</code>: <code>&gt;=1.0.0.0 &amp;&amp; &lt;1.0.0.3</code></dd><dd><code>Network.Gopher.Util.sanitizePath</code>: <code>&gt;=1.0.0.0 &amp;&amp; &lt;1.0.0.3</code></dd><dd><code>Network.Gopher.Util.santinizeIfNotUrl</code>: <code>&gt;=0.2.0.0 &amp;&amp; &lt;1.0</code></dd><dd><code>Network.Gopher.Util.santinizePath</code>: <code>&gt;=0.2.0.0 &amp;&amp; &lt;1.0</code></dd></dl></div></div><footer><div class="HF">This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The Haskell Foundation</a>.</div></footer></body></html></html>