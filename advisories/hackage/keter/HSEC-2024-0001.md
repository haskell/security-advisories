``` toml
[advisory]
cwe = [79]
date = 2024-02-27T17:06:24Z
id = "HSEC-2024-0001"
keywords = ["http", "xss", "rxss", "historic"]
modified = 2024-02-27T17:06:24Z

[[affected]]
cvss = "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N"
package = "keter"

[affected.declarations]
"Keter.Proxy.toResponse" = ">=0.3.4 && <1.0.1"
"Keter.Proxy.unknownHostResponse" = ">=1.0.1 && <1.8.4"

[[affected.versions]]
fixed = "1.8.4"
introduced = "0.3.4"

[[references]]
type = "FIX"
url = "https://github.com/snoyberg/keter/pull/246"
```

# Reflected XSS vulnerability in keter

Keter is an app-server/reverse-proxy often used with webapps build on
Yesod web-framework.

In the logic handling VHost dispatch, Keter was echoing back `Host`
header value, unescaped, as part of an HTML error page. This constitutes
a reflected-XSS vulnerability. Although not readily exploitable directly
from a browser (where `Host` header can't generally assume arbitrary
values), it may become such in presence of further weaknesses in
components upstream of Keter in the http proxying chain. Therefore,
AC:High in CVSS evaluation.
